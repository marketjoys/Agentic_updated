/*! For license information please see 364.d28dcbb9.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkemail_responder_frontend=self.webpackChunkemail_responder_frontend||[]).push([[364],{364:(e,s,t)=>{t.r(s),t.d(s,{default:()=>v});var a=t(5043),l=t(1360),i=t(5746),n=t(4830),r=t(9340),o=t(7118),d=t(4319),c=t(9875),m=t(5613),p=t(8646),x=t(5087),u=t(4505),h=t(3768),g=t(579);const f=e=>{let{campaign:s,onSend:t,onView:a}=e;console.log("\ud83d\udd0d Campaign card rendered:",s),console.log("\ud83d\udd0d Campaign status:",s.status),console.log("\ud83d\udd0d Is draft?","draft"===s.status);const l=e=>"draft"===e;return(0,g.jsx)("div",{className:"card",children:(0,g.jsxs)("div",{className:"card-body",children:[(0,g.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,g.jsx)("h3",{className:"text-lg font-semibold text-secondary-900",children:s.name}),(0,g.jsxs)("div",{className:"flex items-center space-x-2",children:[(e=>{switch(e){case"active":return(0,g.jsx)(n.A,{className:"h-4 w-4"});case"draft":return(0,g.jsx)(r.A,{className:"h-4 w-4"});case"completed":case"sent":return(0,g.jsx)(d.A,{className:"h-4 w-4"});case"failed":return(0,g.jsx)(c.A,{className:"h-4 w-4"});default:return(0,g.jsx)(m.A,{className:"h-4 w-4"})}})(s.status),(0,g.jsx)("span",{className:`px-2 py-1 text-xs rounded-full ${(e=>{switch(e){case"active":return"bg-green-100 text-green-800";case"draft":return"bg-yellow-100 text-yellow-800";case"paused":return"bg-orange-100 text-orange-800";case"completed":case"sent":return"bg-purple-100 text-purple-800";case"failed":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}})(s.status)}`,children:s.status})]})]}),(0,g.jsxs)("div",{className:"space-y-2 mb-4",children:[(0,g.jsxs)("div",{className:"flex items-center text-sm text-secondary-600",children:[(0,g.jsx)(o.A,{className:"h-4 w-4 mr-2"}),(0,g.jsxs)("span",{children:[s.prospect_count||0," prospects"]})]}),(0,g.jsxs)("div",{className:"flex items-center text-sm text-secondary-600",children:[(0,g.jsx)(i.A,{className:"h-4 w-4 mr-2"}),(0,g.jsxs)("span",{children:["Max ",s.max_emails," emails"]})]}),s.schedule&&(0,g.jsxs)("div",{className:"flex items-center text-sm text-secondary-600",children:[(0,g.jsx)(p.A,{className:"h-4 w-4 mr-2"}),(0,g.jsx)("span",{children:new Date(s.schedule).toLocaleDateString()})]})]}),(0,g.jsxs)("div",{className:"flex items-center justify-between",children:[(0,g.jsxs)("div",{className:"text-xs text-secondary-400",children:["Created ",new Date(s.created_at).toLocaleDateString()]}),(0,g.jsxs)("div",{className:"flex space-x-2",children:[(0,g.jsx)("button",{onClick:()=>a(s.id),className:"p-1 text-secondary-400 hover:text-primary-600 transition-colors",title:"View Campaign Details",children:(0,g.jsx)(x.A,{className:"h-4 w-4"})}),l(s.status)&&(0,g.jsx)("button",{onClick:()=>t(s.id),className:"p-2 bg-green-100 text-green-600 hover:bg-green-200 hover:text-green-700 rounded-md transition-colors",title:"Send Campaign",children:(0,g.jsx)(n.A,{className:"h-4 w-4"})}),!l(s.status)&&"draft"!==s.status&&(0,g.jsx)("button",{disabled:!0,className:"p-2 bg-gray-100 text-gray-400 rounded-md cursor-not-allowed",title:`Campaign ${s.status} - Cannot send again`,children:(0,g.jsx)(n.A,{className:"h-4 w-4"})})]})]})]})})},y=e=>{let{templates:s,onClose:t,onSave:l}=e;const[i,n]=(0,a.useState)([]),[r,o]=(0,a.useState)([]),[d,c]=(0,a.useState)(!0),[m,p]=(0,a.useState)({name:"",template_id:"",list_ids:[],email_provider_id:"",max_emails:1e3,schedule_type:"immediate",start_time:"",follow_up_enabled:!0,follow_up_schedule_type:"interval",follow_up_intervals:[3,7,14],follow_up_dates:[],follow_up_timezone:"UTC",follow_up_time_window_start:"09:00",follow_up_time_window_end:"17:00",follow_up_days_of_week:["monday","tuesday","wednesday","thursday","friday"],follow_up_templates:[]});(0,a.useEffect)(()=>{x()},[]);const x=async()=>{try{const[e,s]=await Promise.all([u.K.getLists(),u.K.getEmailProviders()]);n(e.data),o(s.data)}catch(e){h.Ay.error("Failed to load campaign data")}finally{c(!1)}},f=e=>{const{name:s,value:t,type:a,checked:l}=e.target;p({...m,[s]:"checkbox"===a?l:t})},y=s.filter(e=>"initial"===e.type),j=s.filter(e=>"follow_up"===e.type);return d?(0,g.jsx)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:(0,g.jsxs)("div",{className:"flex items-center justify-center min-h-screen px-4",children:[(0,g.jsx)("div",{className:"fixed inset-0 bg-black opacity-30"}),(0,g.jsx)("div",{className:"relative bg-white rounded-lg max-w-2xl w-full p-6",children:(0,g.jsx)("div",{className:"flex items-center justify-center h-32",children:(0,g.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"})})})]})}):(0,g.jsx)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:(0,g.jsxs)("div",{className:"flex items-center justify-center min-h-screen px-4",children:[(0,g.jsx)("div",{className:"fixed inset-0 bg-black opacity-30"}),(0,g.jsxs)("div",{className:"relative bg-white rounded-lg max-w-4xl w-full p-6 max-h-[90vh] overflow-y-auto",children:[(0,g.jsx)("h3",{className:"text-lg font-semibold text-secondary-900 mb-4",children:"Create New Campaign"}),(0,g.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),0===m.list_ids.length)return void h.Ay.error("Please select at least one prospect list");if(!m.email_provider_id)return void h.Ay.error("Please select an email provider");if(m.follow_up_enabled){if("datetime"===m.follow_up_schedule_type&&0===m.follow_up_dates.length)return void h.Ay.error("Please add at least one follow-up date or switch to interval-based scheduling");if("interval"===m.follow_up_schedule_type){if(0===m.follow_up_intervals.filter(e=>e>0).length)return void h.Ay.error("Please set at least one valid follow-up interval")}if(0===m.follow_up_days_of_week.length)return void h.Ay.error("Please select at least one day for sending follow-ups")}const s={...m,start_time:m.start_time?new Date(m.start_time).toISOString():null,follow_up_intervals:m.follow_up_intervals.filter(e=>e>0),follow_up_dates:m.follow_up_dates.map(e=>new Date(e).toISOString())};l(s)},className:"space-y-6",children:[(0,g.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,g.jsx)("h4",{className:"font-medium text-secondary-900 mb-3",children:"Basic Information"}),(0,g.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,g.jsxs)("div",{children:[(0,g.jsx)("label",{className:"block text-sm font-medium text-secondary-700 mb-1",children:"Campaign Name *"}),(0,g.jsx)("input",{type:"text",name:"name",value:m.name,onChange:f,className:"input",required:!0,placeholder:"Enter campaign name"})]}),(0,g.jsxs)("div",{children:[(0,g.jsx)("label",{className:"block text-sm font-medium text-secondary-700 mb-1",children:"Max Emails"}),(0,g.jsx)("input",{type:"number",name:"max_emails",value:m.max_emails,onChange:f,className:"input",min:"1",max:"10000"})]})]})]}),(0,g.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,g.jsx)("h4",{className:"font-medium text-secondary-900 mb-3",children:"Email Provider *"}),(0,g.jsxs)("select",{name:"email_provider_id",value:m.email_provider_id,onChange:f,className:"input w-full",required:!0,children:[(0,g.jsx)("option",{value:"",children:"Select email provider"}),r.map(e=>(0,g.jsxs)("option",{value:e.id,children:[e.name," (",e.email_address,")"]},e.id))]}),0===r.length&&(0,g.jsx)("p",{className:"text-sm text-orange-600 mt-2",children:"No email providers configured. Please add an email provider first."})]}),(0,g.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,g.jsx)("h4",{className:"font-medium text-secondary-900 mb-3",children:"Initial Template *"}),(0,g.jsxs)("select",{name:"template_id",value:m.template_id,onChange:f,className:"input w-full",required:!0,children:[(0,g.jsx)("option",{value:"",children:"Select initial template"}),y.map(e=>(0,g.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,g.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,g.jsx)("h4",{className:"font-medium text-secondary-900 mb-3",children:"Target Prospect Lists *"}),(0,g.jsx)("div",{className:"max-h-32 overflow-y-auto space-y-2",children:i.map(e=>(0,g.jsxs)("label",{className:"flex items-center space-x-2 cursor-pointer",children:[(0,g.jsx)("input",{type:"checkbox",checked:m.list_ids.includes(e.id),onChange:()=>{return s=e.id,void p(e=>({...e,list_ids:e.list_ids.includes(s)?e.list_ids.filter(e=>e!==s):[...e.list_ids,s]}));var s},className:"h-4 w-4 text-primary-600 rounded"}),(0,g.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,g.jsx)("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:e.color}}),(0,g.jsxs)("span",{className:"text-sm text-secondary-700",children:[e.name," (",e.prospect_count," prospects)"]})]})]},e.id))}),0===i.length&&(0,g.jsx)("p",{className:"text-sm text-orange-600",children:"No prospect lists available. Please create prospect lists first."}),m.list_ids.length>0&&(0,g.jsxs)("p",{className:"text-sm text-green-600 mt-2",children:[m.list_ids.length," list(s) selected"]})]}),(0,g.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,g.jsx)("h4",{className:"font-medium text-secondary-900 mb-3",children:"Scheduling"}),(0,g.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,g.jsxs)("div",{children:[(0,g.jsx)("label",{className:"block text-sm font-medium text-secondary-700 mb-1",children:"Schedule Type"}),(0,g.jsxs)("select",{name:"schedule_type",value:m.schedule_type,onChange:f,className:"input",children:[(0,g.jsx)("option",{value:"immediate",children:"Send Immediately"}),(0,g.jsx)("option",{value:"scheduled",children:"Schedule for Later"})]})]}),"scheduled"===m.schedule_type&&(0,g.jsxs)("div",{children:[(0,g.jsx)("label",{className:"block text-sm font-medium text-secondary-700 mb-1",children:"Start Time *"}),(0,g.jsx)("input",{type:"datetime-local",name:"start_time",value:m.start_time,onChange:f,className:"input",required:"scheduled"===m.schedule_type})]})]})]}),(0,g.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,g.jsx)("h4",{className:"font-medium text-secondary-900 mb-3",children:"Follow-up Configuration"}),(0,g.jsxs)("div",{className:"space-y-4",children:[(0,g.jsxs)("label",{className:"flex items-center space-x-2",children:[(0,g.jsx)("input",{type:"checkbox",name:"follow_up_enabled",checked:m.follow_up_enabled,onChange:f,className:"h-4 w-4 text-primary-600 rounded"}),(0,g.jsx)("span",{className:"text-sm text-secondary-700",children:"Enable Follow-up Emails"})]}),m.follow_up_enabled&&(0,g.jsxs)(g.Fragment,{children:[(0,g.jsxs)("div",{children:[(0,g.jsx)("label",{className:"block text-sm font-medium text-secondary-700 mb-2",children:"Schedule Type"}),(0,g.jsxs)("select",{name:"follow_up_schedule_type",value:m.follow_up_schedule_type,onChange:f,className:"input w-full",children:[(0,g.jsx)("option",{value:"interval",children:"Interval-based (days after last contact)"}),(0,g.jsx)("option",{value:"datetime",children:"Specific date and time"})]})]}),(0,g.jsxs)("div",{children:[(0,g.jsx)("label",{className:"block text-sm font-medium text-secondary-700 mb-2",children:"Timezone"}),(0,g.jsxs)("select",{name:"follow_up_timezone",value:m.follow_up_timezone,onChange:f,className:"input w-full",children:[(0,g.jsx)("option",{value:"UTC",children:"UTC"}),(0,g.jsx)("option",{value:"America/New_York",children:"Eastern Time"}),(0,g.jsx)("option",{value:"America/Chicago",children:"Central Time"}),(0,g.jsx)("option",{value:"America/Denver",children:"Mountain Time"}),(0,g.jsx)("option",{value:"America/Los_Angeles",children:"Pacific Time"}),(0,g.jsx)("option",{value:"Europe/London",children:"London"}),(0,g.jsx)("option",{value:"Europe/Paris",children:"Paris"}),(0,g.jsx)("option",{value:"Asia/Tokyo",children:"Tokyo"}),(0,g.jsx)("option",{value:"Asia/Shanghai",children:"Shanghai"}),(0,g.jsx)("option",{value:"Asia/Kolkata",children:"India"})]})]}),"interval"===m.follow_up_schedule_type&&(0,g.jsxs)("div",{children:[(0,g.jsx)("label",{className:"block text-sm font-medium text-secondary-700 mb-2",children:"Follow-up Intervals (days)"}),(0,g.jsx)("div",{className:"flex space-x-2",children:m.follow_up_intervals.map((e,s)=>(0,g.jsx)("input",{type:"number",value:e,onChange:e=>((e,s)=>{const t=[...m.follow_up_intervals];t[e]=parseInt(s)||0,p(e=>({...e,follow_up_intervals:t}))})(s,e.target.value),className:"input w-20",min:"1",max:"30",placeholder:`Day ${s+1}`},s))}),(0,g.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Days after initial contact or last follow-up"})]}),"datetime"===m.follow_up_schedule_type&&(0,g.jsxs)("div",{children:[(0,g.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,g.jsx)("label",{className:"block text-sm font-medium text-secondary-700",children:"Follow-up Date & Times"}),(0,g.jsx)("button",{type:"button",onClick:()=>{const e=new Date;e.setDate(e.getDate()+m.follow_up_dates.length+1);const s=e.toISOString().slice(0,16);p(e=>({...e,follow_up_dates:[...e.follow_up_dates,s]}))},className:"text-sm bg-blue-100 text-blue-600 px-2 py-1 rounded hover:bg-blue-200",children:"Add Date"})]}),(0,g.jsxs)("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:[m.follow_up_dates.map((e,s)=>(0,g.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,g.jsx)("input",{type:"datetime-local",value:e,onChange:e=>((e,s)=>{const t=[...m.follow_up_dates];t[e]=s,p(e=>({...e,follow_up_dates:t}))})(s,e.target.value),className:"input flex-1",min:(new Date).toISOString().slice(0,16)}),(0,g.jsx)("button",{type:"button",onClick:()=>(e=>{const s=m.follow_up_dates.filter((s,t)=>t!==e);p(e=>({...e,follow_up_dates:s}))})(s),className:"text-red-600 hover:text-red-800 px-2 py-1",title:"Remove date",children:"\u2715"})]},s)),0===m.follow_up_dates.length&&(0,g.jsx)("p",{className:"text-sm text-gray-500",children:'No specific dates set. Click "Add Date" to schedule follow-ups.'})]})]}),(0,g.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,g.jsxs)("div",{children:[(0,g.jsx)("label",{className:"block text-sm font-medium text-secondary-700 mb-1",children:"Send Time Window Start"}),(0,g.jsx)("input",{type:"time",name:"follow_up_time_window_start",value:m.follow_up_time_window_start,onChange:f,className:"input"})]}),(0,g.jsxs)("div",{children:[(0,g.jsx)("label",{className:"block text-sm font-medium text-secondary-700 mb-1",children:"Send Time Window End"}),(0,g.jsx)("input",{type:"time",name:"follow_up_time_window_end",value:m.follow_up_time_window_end,onChange:f,className:"input"})]})]}),(0,g.jsxs)("div",{children:[(0,g.jsx)("label",{className:"block text-sm font-medium text-secondary-700 mb-2",children:"Send Days (Select days when follow-ups can be sent)"}),(0,g.jsx)("div",{className:"flex flex-wrap gap-2",children:["monday","tuesday","wednesday","thursday","friday","saturday","sunday"].map(e=>(0,g.jsx)("button",{type:"button",onClick:()=>(e=>{const s=m.follow_up_days_of_week.includes(e);p(s?s=>({...s,follow_up_days_of_week:s.follow_up_days_of_week.filter(s=>s!==e)}):s=>({...s,follow_up_days_of_week:[...s.follow_up_days_of_week,e]}))})(e),className:"px-3 py-1 text-xs rounded-full border transition-colors "+(m.follow_up_days_of_week.includes(e)?"bg-primary-100 text-primary-700 border-primary-300":"bg-gray-100 text-gray-600 border-gray-300 hover:bg-gray-200"),children:e.charAt(0).toUpperCase()+e.slice(1)},e))})]}),(0,g.jsxs)("div",{children:[(0,g.jsx)("label",{className:"block text-sm font-medium text-secondary-700 mb-2",children:"Follow-up Templates (Optional)"}),(0,g.jsx)("div",{className:"max-h-24 overflow-y-auto space-y-2",children:j.map(e=>(0,g.jsxs)("label",{className:"flex items-center space-x-2 cursor-pointer",children:[(0,g.jsx)("input",{type:"checkbox",checked:m.follow_up_templates.includes(e.id),onChange:()=>{return s=e.id,void p(e=>({...e,follow_up_templates:e.follow_up_templates.includes(s)?e.follow_up_templates.filter(e=>e!==s):[...e.follow_up_templates,s]}));var s},className:"h-4 w-4 text-primary-600 rounded"}),(0,g.jsx)("span",{className:"text-sm text-secondary-700",children:e.name})]},e.id))}),0===j.length&&(0,g.jsx)("p",{className:"text-sm text-gray-500",children:"No follow-up templates available"})]})]})]})]}),(0,g.jsxs)("div",{className:"flex justify-end space-x-3 pt-4 border-t",children:[(0,g.jsx)("button",{type:"button",onClick:t,className:"btn btn-secondary",children:"Cancel"}),(0,g.jsx)("button",{type:"submit",className:"btn btn-primary",children:"Create Campaign"})]})]})]})]})})},j=e=>{var s,t,a,l,i,o;let{campaign:p,onClose:x}=e;return(0,g.jsx)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:(0,g.jsxs)("div",{className:"flex items-center justify-center min-h-screen px-4",children:[(0,g.jsx)("div",{className:"fixed inset-0 bg-black opacity-30"}),(0,g.jsxs)("div",{className:"relative bg-white rounded-lg max-w-4xl w-full p-6 max-h-[90vh] overflow-y-auto",children:[(0,g.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,g.jsx)("h3",{className:"text-2xl font-bold text-secondary-900",children:"Campaign Details"}),(0,g.jsx)("button",{onClick:x,className:"text-secondary-400 hover:text-secondary-600 transition-colors",children:(0,g.jsx)(c.A,{className:"h-6 w-6"})})]}),(0,g.jsxs)("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 rounded-lg p-6 mb-6",children:[(0,g.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,g.jsx)("h4",{className:"text-xl font-semibold text-secondary-900",children:p.name}),(0,g.jsxs)("div",{className:`flex items-center space-x-2 px-3 py-2 rounded-full border ${(e=>{switch(e){case"active":return"bg-green-100 text-green-800 border-green-200";case"draft":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"paused":return"bg-orange-100 text-orange-800 border-orange-200";case"completed":case"sent":return"bg-purple-100 text-purple-800 border-purple-200";case"failed":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}})(p.status)}`,children:[(e=>{switch(e){case"active":return(0,g.jsx)(n.A,{className:"h-5 w-5"});case"draft":return(0,g.jsx)(r.A,{className:"h-5 w-5"});case"completed":case"sent":return(0,g.jsx)(d.A,{className:"h-5 w-5"});case"failed":return(0,g.jsx)(c.A,{className:"h-5 w-5"});default:return(0,g.jsx)(m.A,{className:"h-5 w-5"})}})(p.status),(0,g.jsx)("span",{className:"font-medium capitalize",children:p.status})]})]}),(0,g.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,g.jsxs)("div",{className:"text-center",children:[(0,g.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:p.prospect_count||0}),(0,g.jsx)("div",{className:"text-sm text-secondary-600",children:"Prospects"})]}),(0,g.jsxs)("div",{className:"text-center",children:[(0,g.jsx)("div",{className:"text-2xl font-bold text-green-600",children:(null===(s=p.analytics)||void 0===s?void 0:s.total_sent)||0}),(0,g.jsx)("div",{className:"text-sm text-secondary-600",children:"Emails Sent"})]}),(0,g.jsxs)("div",{className:"text-center",children:[(0,g.jsxs)("div",{className:"text-2xl font-bold text-purple-600",children:[(null===(t=p.analytics)||void 0===t||null===(a=t.success_rate)||void 0===a?void 0:a.toFixed(1))||0,"%"]}),(0,g.jsx)("div",{className:"text-sm text-secondary-600",children:"Success Rate"})]})]})]}),(0,g.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[(0,g.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,g.jsx)("h5",{className:"font-semibold text-secondary-900 mb-3",children:"Campaign Information"}),(0,g.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,g.jsxs)("div",{className:"flex justify-between",children:[(0,g.jsx)("span",{className:"text-secondary-600",children:"Created:"}),(0,g.jsx)("span",{className:"text-secondary-900",children:new Date(p.created_at).toLocaleDateString()})]}),(0,g.jsxs)("div",{className:"flex justify-between",children:[(0,g.jsx)("span",{className:"text-secondary-600",children:"Max Emails:"}),(0,g.jsx)("span",{className:"text-secondary-900",children:p.max_emails})]}),p.schedule&&(0,g.jsxs)("div",{className:"flex justify-between",children:[(0,g.jsx)("span",{className:"text-secondary-600",children:"Scheduled:"}),(0,g.jsx)("span",{className:"text-secondary-900",children:new Date(p.schedule).toLocaleDateString()})]})]})]}),(0,g.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,g.jsx)("h5",{className:"font-semibold text-secondary-900 mb-3",children:"Email Analytics"}),(0,g.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,g.jsxs)("div",{className:"flex justify-between",children:[(0,g.jsx)("span",{className:"text-secondary-600",children:"Total Emails:"}),(0,g.jsx)("span",{className:"text-secondary-900",children:(null===(l=p.analytics)||void 0===l?void 0:l.total_emails)||0})]}),(0,g.jsxs)("div",{className:"flex justify-between",children:[(0,g.jsx)("span",{className:"text-green-600",children:"Sent:"}),(0,g.jsx)("span",{className:"text-green-700 font-medium",children:(null===(i=p.analytics)||void 0===i?void 0:i.total_sent)||0})]}),(0,g.jsxs)("div",{className:"flex justify-between",children:[(0,g.jsx)("span",{className:"text-red-600",children:"Failed:"}),(0,g.jsx)("span",{className:"text-red-700 font-medium",children:(null===(o=p.analytics)||void 0===o?void 0:o.total_failed)||0})]})]})]})]}),p.template&&(0,g.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 mb-6",children:[(0,g.jsx)("h5",{className:"font-semibold text-secondary-900 mb-3",children:"Template"}),(0,g.jsxs)("div",{className:"space-y-2",children:[(0,g.jsxs)("div",{className:"text-sm text-secondary-600",children:[(0,g.jsx)("strong",{children:"Name:"})," ",p.template.name]}),(0,g.jsxs)("div",{className:"text-sm text-secondary-600",children:[(0,g.jsx)("strong",{children:"Subject:"})," ",p.template.subject]}),(0,g.jsxs)("div",{className:"text-sm text-secondary-600",children:[(0,g.jsx)("strong",{children:"Type:"})," ",p.template.type]})]})]}),p.lists&&p.lists.length>0&&(0,g.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 mb-6",children:[(0,g.jsx)("h5",{className:"font-semibold text-secondary-900 mb-3",children:"Target Lists"}),(0,g.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:p.lists.map(e=>(0,g.jsxs)("div",{className:"flex items-center space-x-3 p-2 bg-white rounded border",children:[(0,g.jsx)("div",{className:"w-4 h-4 rounded-full",style:{backgroundColor:e.color}}),(0,g.jsxs)("div",{className:"flex-1",children:[(0,g.jsx)("div",{className:"text-sm font-medium text-secondary-900",children:e.name}),(0,g.jsxs)("div",{className:"text-xs text-secondary-600",children:[e.prospect_count," prospects"]})]})]},e.id))})]}),p.email_records&&p.email_records.length>0&&(0,g.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 mb-6",children:[(0,g.jsxs)("h5",{className:"font-semibold text-secondary-900 mb-3",children:["Email Records (",p.email_records.length,")"]}),(0,g.jsx)("div",{className:"max-h-64 overflow-y-auto",children:(0,g.jsxs)("div",{className:"space-y-2",children:[p.email_records.slice(0,10).map((e,s)=>(0,g.jsxs)("div",{className:"flex items-center justify-between p-2 bg-white rounded border text-sm",children:[(0,g.jsxs)("div",{className:"flex-1",children:[(0,g.jsx)("div",{className:"font-medium text-secondary-900",children:e.recipient_email}),(0,g.jsx)("div",{className:"text-xs text-secondary-600",children:e.subject})]}),(0,g.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,g.jsx)("span",{className:"px-2 py-1 text-xs rounded-full "+("sent"===e.status?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:e.status}),e.sent_at&&(0,g.jsx)("span",{className:"text-xs text-secondary-400",children:new Date(e.sent_at).toLocaleDateString()})]})]},e.id||s)),p.email_records.length>10&&(0,g.jsxs)("div",{className:"text-center text-sm text-secondary-600 p-2",children:["... and ",p.email_records.length-10," more records"]})]})})]}),(0,g.jsx)("div",{className:"flex justify-end pt-4 border-t",children:(0,g.jsx)("button",{onClick:x,className:"btn btn-secondary",children:"Close"})})]})]})})},v=()=>{const[e,s]=(0,a.useState)([]),[t,d]=(0,a.useState)([]),[c,m]=(0,a.useState)(!0),[p,x]=(0,a.useState)(!1),[v,w]=(0,a.useState)(!1),[N,b]=(0,a.useState)(null);(0,a.useEffect)(()=>{_()},[]);const _=async()=>{console.log("\ud83d\udd04 Starting loadData..."),await new Promise(e=>setTimeout(e,100));try{console.log("\ud83d\udd04 Loading campaigns and templates...");const e=await u.K.getCampaigns();console.log("\ud83d\udcca Campaigns response:",e.data);const t=await u.K.getTemplates();console.log("\ud83d\udcdd Templates response:",t.data),console.log("\ud83d\udd04 Setting state..."),e.data&&Array.isArray(e.data)?(s(e.data),console.log("\u2705 Campaigns state set successfully")):(console.warn("\u26a0\ufe0f Invalid campaigns data:",e.data),s([])),t.data&&Array.isArray(t.data)?(d(t.data),console.log("\u2705 Templates state set successfully")):(console.warn("\u26a0\ufe0f Invalid templates data:",t.data),d([])),console.log("\u2705 Data loaded successfully"),console.log("\ud83d\udd04 Setting loading to false...")}catch(l){var e,t,a;console.error("\u274c Error loading data:",l),console.error("Error details:",(null===(e=l.response)||void 0===e?void 0:e.data)||l.message),s([]),d([]),h.Ay.error("Failed to load data: "+((null===(t=l.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.detail)||l.message))}finally{console.log("\ud83d\udd04 Finally block: setting loading to false"),m(!1)}},C=async e=>{console.log("\ud83d\udc41\ufe0f handleViewCampaign called with campaignId:",e);try{console.log("\ud83d\udce1 Fetching campaign details via API...");const s=await u.K.getCampaign(e);console.log("\u2705 Campaign details fetched successfully:",s.data),b(s.data),w(!0)}catch(l){var s,t,a;console.error("\u274c Failed to fetch campaign details:",l),console.error("Error details:",(null===(s=l.response)||void 0===s?void 0:s.data)||l.message);const e=(null===(t=l.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.detail)||"Failed to fetch campaign details";h.Ay.error(e,{duration:5e3,position:"top-right"})}},k=async e=>{console.log("\ud83d\ude80 handleSendCampaign called with campaignId:",e);try{console.log("\ud83d\udce1 Sending campaign via API...");const s=await u.K.sendCampaign(e);console.log("\u2705 Campaign sent successfully:",s.data);const t=s.data,a=`Campaign sent successfully! ${t.total_sent} emails sent, ${t.total_failed} failed.`;h.Ay.success(a,{duration:6e3,position:"top-right"}),_()}catch(l){var s,t,a;console.error("\u274c Campaign sending failed:",l),console.error("Error details:",(null===(s=l.response)||void 0===s?void 0:s.data)||l.message);const e=(null===(t=l.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.detail)||"Failed to send campaign";h.Ay.error(e,{duration:8e3,position:"top-right"})}};return c?(0,g.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,g.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"})}):(0,g.jsxs)("div",{className:"space-y-6",children:[(0,g.jsxs)("div",{className:"flex items-center justify-between",children:[(0,g.jsx)("h1",{className:"text-3xl font-bold text-secondary-900",children:"Campaigns"}),(0,g.jsxs)("button",{onClick:()=>x(!0),className:"btn btn-primary",children:[(0,g.jsx)(l.A,{className:"h-4 w-4 mr-2"}),"New Campaign"]})]}),(0,g.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,g.jsx)("div",{className:"card",children:(0,g.jsx)("div",{className:"card-body",children:(0,g.jsxs)("div",{className:"flex items-center justify-between",children:[(0,g.jsxs)("div",{children:[(0,g.jsx)("p",{className:"text-sm text-secondary-600",children:"Total Campaigns"}),(0,g.jsx)("p",{className:"text-2xl font-bold text-secondary-900",children:e.length})]}),(0,g.jsx)(i.A,{className:"h-8 w-8 text-blue-600"})]})})}),(0,g.jsx)("div",{className:"card",children:(0,g.jsx)("div",{className:"card-body",children:(0,g.jsxs)("div",{className:"flex items-center justify-between",children:[(0,g.jsxs)("div",{children:[(0,g.jsx)("p",{className:"text-sm text-secondary-600",children:"Active"}),(0,g.jsx)("p",{className:"text-2xl font-bold text-green-600",children:e.filter(e=>"active"===e.status).length})]}),(0,g.jsx)(n.A,{className:"h-8 w-8 text-green-600"})]})})}),(0,g.jsx)("div",{className:"card",children:(0,g.jsx)("div",{className:"card-body",children:(0,g.jsxs)("div",{className:"flex items-center justify-between",children:[(0,g.jsxs)("div",{children:[(0,g.jsx)("p",{className:"text-sm text-secondary-600",children:"Draft"}),(0,g.jsx)("p",{className:"text-2xl font-bold text-yellow-600",children:e.filter(e=>"draft"===e.status).length})]}),(0,g.jsx)(r.A,{className:"h-8 w-8 text-yellow-600"})]})})}),(0,g.jsx)("div",{className:"card",children:(0,g.jsx)("div",{className:"card-body",children:(0,g.jsxs)("div",{className:"flex items-center justify-between",children:[(0,g.jsxs)("div",{children:[(0,g.jsx)("p",{className:"text-sm text-secondary-600",children:"Completed"}),(0,g.jsx)("p",{className:"text-2xl font-bold text-purple-600",children:e.filter(e=>"completed"===e.status||"sent"===e.status).length})]}),(0,g.jsx)(o.A,{className:"h-8 w-8 text-purple-600"})]})})})]}),(0,g.jsx)("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6",children:e.map(e=>(0,g.jsx)(f,{campaign:e,onSend:k,onView:C},e.id))}),p&&(0,g.jsx)(y,{templates:t,onClose:()=>x(!1),onSave:async e=>{try{await u.K.createCampaign(e),h.Ay.success("Campaign created successfully"),x(!1),_()}catch(s){h.Ay.error("Failed to create campaign")}}}),v&&N&&(0,g.jsx)(j,{campaign:N,onClose:()=>{w(!1),b(null)}})]})}},1360:(e,s,t)=>{t.d(s,{A:()=>a});const a=(0,t(1639).A)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},4505:(e,s,t)=>{t.d(s,{A:()=>r,K:()=>n});var a=t(6213);const l="https://030d008b-cc85-4bf3-afdd-411b8004d718.preview.emergentagent.com",i=a.A.create({baseURL:l,headers:{"Content-Type":"application/json"}});i.interceptors.request.use(e=>{var s;console.log("API Request:",null===(s=e.method)||void 0===s?void 0:s.toUpperCase(),e.url);const t=localStorage.getItem("token");return t&&(e.headers.Authorization=`Bearer ${t}`),e},e=>Promise.reject(e)),i.interceptors.response.use(e=>e,async e=>{var s,t;if(console.error("API Error:",(null===(s=e.response)||void 0===s?void 0:s.data)||e.message),401===(null===(t=e.response)||void 0===t?void 0:t.status)){console.log("Received 401 error, attempting token refresh...");if(localStorage.getItem("token"))try{const s=await a.A.post(`${l}/api/auth/refresh`),{access_token:t}=s.data;localStorage.setItem("token",t);const i=e.config;return i.headers.Authorization=`Bearer ${t}`,(0,a.A)(i)}catch(i){console.error("Token refresh failed:",i),localStorage.removeItem("token"),window.location.href="/"}}return Promise.reject(e)});const n={healthCheck:()=>i.get("/api/health"),getProspects:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;return i.get(`/api/prospects?skip=${e}&limit=${s}`)},createProspect:e=>i.post("/api/prospects",e),uploadProspects:e=>{const s=new FormData;return s.append("file",e),i.post("/api/prospects/upload",s,{headers:{"Content-Type":"multipart/form-data"}})},getTemplates:()=>i.get("/api/templates"),createTemplate:e=>i.post("/api/templates",e),getTemplate:e=>i.get(`/api/templates/${e}`),updateTemplate:(e,s)=>i.put(`/api/templates/${e}`,s),getCampaigns:()=>i.get("/api/campaigns"),createCampaign:e=>i.post("/api/campaigns",e),getCampaign:e=>i.get(`/api/campaigns/${e}`),sendCampaign:function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};console.log("\ud83d\udce1 sendCampaign called with id:",e,"sendRequest:",s);const t={send_immediately:!0,email_provider_id:"",max_emails:1e3,schedule_type:"immediate",start_time:null,follow_up_enabled:!0,follow_up_intervals:[3,7,14],follow_up_templates:[],...s};return console.log("\ud83d\udce4 Final send request:",t),console.log("\ud83c\udfaf Making POST request to:",`/api/campaigns/${e}/send`),i.post(`/api/campaigns/${e}/send`,t)},getIntents:()=>i.get("/api/intents"),createIntent:e=>i.post("/api/intents",e),getIntent:e=>i.get(`/api/intents/${e}`),updateIntent:(e,s)=>i.put(`/api/intents/${e}`,s),deleteIntent:e=>i.delete(`/api/intents/${e}`),getCampaignAnalytics:e=>i.get(`/api/analytics/campaign/${e}`),getLists:()=>i.get("/api/lists"),createList:e=>i.post("/api/lists",e),getList:e=>i.get(`/api/lists/${e}`),updateList:(e,s)=>i.put(`/api/lists/${e}`,s),deleteList:e=>i.delete(`/api/lists/${e}`),addProspectsToList:(e,s)=>i.post(`/api/lists/${e}/prospects`,{prospect_ids:s}),removeProspectsFromList:(e,s)=>i.delete(`/api/lists/${e}/prospects`,{data:{prospect_ids:s}}),startEmailProcessing:()=>i.post("/api/email-processing/start"),stopEmailProcessing:()=>i.post("/api/email-processing/stop"),getProcessingStatus:()=>i.get("/api/email-processing/status"),getProcessingAnalytics:()=>i.get("/api/email-processing/analytics"),testIntentClassification:e=>i.post("/api/email-processing/test-classification",e),testResponseGeneration:e=>i.post("/api/email-processing/test-response",e),getThreads:()=>i.get("/api/threads"),getThread:e=>i.get(`/api/threads/${e}`),getThreadByProspect:e=>i.get(`/api/threads/prospect/${e}`),addMessageToThread:(e,s)=>i.post(`/api/threads/${e}/messages`,s),getEmailProviders:()=>i.get("/api/email-providers"),createEmailProvider:e=>i.post("/api/email-providers",e),updateEmailProvider:(e,s)=>i.put(`/api/email-providers/${e}`,s),deleteEmailProvider:e=>i.delete(`/api/email-providers/${e}`),setDefaultEmailProvider:e=>i.post(`/api/email-providers/${e}/set-default`),testEmailProvider:e=>i.post(`/api/email-providers/${e}/test-connection`),getFollowUpDashboard:()=>i.get("/api/follow-up-monitoring/dashboard"),getImapScanStatus:()=>i.get("/api/follow-up-monitoring/imap-scan-status"),getImapLogs:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:24;return i.get(`/api/follow-up-monitoring/imap-logs?hours=${e}`)},getProspectResponses:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:7;return i.get(`/api/follow-up-monitoring/prospect-responses?days=${e}`)},analyzeProspectThread:e=>i.get(`/api/follow-up-monitoring/thread-analysis/${e}`),forceStopFollowUp:e=>i.post(`/api/follow-up-monitoring/force-stop-follow-up/${e}`),restartFollowUp:e=>i.post(`/api/follow-up-monitoring/restart-follow-up/${e}`),getFollowUpHealthCheck:()=>i.get("/api/follow-up-monitoring/health-check"),startFollowUpEngine:()=>i.post("/api/follow-up-engine/start"),stopFollowUpEngine:()=>i.post("/api/follow-up-engine/stop"),getFollowUpEngineStatus:()=>i.get("/api/follow-up-engine/status"),getFollowUpStatistics:()=>i.get("/api/follow-up-engine/statistics"),processEmailResponse:e=>i.post("/api/follow-up-engine/process-response",e)},r=i},4830:(e,s,t)=>{t.d(s,{A:()=>a});const a=(0,t(1639).A)("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]])},5613:(e,s,t)=>{t.d(s,{A:()=>a});const a=(0,t(1639).A)("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},8646:(e,s,t)=>{t.d(s,{A:()=>a});const a=(0,t(1639).A)("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]])},9340:(e,s,t)=>{t.d(s,{A:()=>a});const a=(0,t(1639).A)("Pause",[["rect",{width:"4",height:"16",x:"6",y:"4",key:"iffhe4"}],["rect",{width:"4",height:"16",x:"14",y:"4",key:"sjin7j"}]])},9875:(e,s,t)=>{t.d(s,{A:()=>a});const a=(0,t(1639).A)("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])}}]);
//# sourceMappingURL=364.d28dcbb9.chunk.js.map