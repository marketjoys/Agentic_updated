/*! For license information please see 21.91e7ac4f.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkemail_responder_frontend=self.webpackChunkemail_responder_frontend||[]).push([[21],{1885:(e,t,s)=>{s.d(t,{A:()=>a});const a=(0,s(1639).A)("Wifi",[["path",{d:"M5 13a10 10 0 0 1 14 0",key:"6v8j51"}],["path",{d:"M8.5 16.5a5 5 0 0 1 7 0",key:"sej527"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["line",{x1:"12",x2:"12.01",y1:"20",y2:"20",key:"of4bc4"}]])},2861:(e,t,s)=>{s.d(t,{A:()=>a});const a=(0,s(1639).A)("WifiOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M8.5 16.5a5 5 0 0 1 7 0",key:"sej527"}],["path",{d:"M2 8.82a15 15 0 0 1 4.17-2.65",key:"11utq1"}],["path",{d:"M10.66 5c4.01-.36 8.14.9 11.34 3.76",key:"hxefdu"}],["path",{d:"M16.85 11.25a10 10 0 0 1 2.22 1.68",key:"q734kn"}],["path",{d:"M5 13a10 10 0 0 1 5.24-2.76",key:"piq4yl"}],["line",{x1:"12",x2:"12.01",y1:"20",y2:"20",key:"of4bc4"}]])},4505:(e,t,s)=>{s.d(t,{A:()=>o,K:()=>l});var a=s(6213);const i="https://030d008b-cc85-4bf3-afdd-411b8004d718.preview.emergentagent.com",r=a.A.create({baseURL:i,headers:{"Content-Type":"application/json"}});r.interceptors.request.use(e=>{var t;console.log("API Request:",null===(t=e.method)||void 0===t?void 0:t.toUpperCase(),e.url);const s=localStorage.getItem("token");return s&&(e.headers.Authorization=`Bearer ${s}`),e},e=>Promise.reject(e)),r.interceptors.response.use(e=>e,async e=>{var t,s;if(console.error("API Error:",(null===(t=e.response)||void 0===t?void 0:t.data)||e.message),401===(null===(s=e.response)||void 0===s?void 0:s.status)){console.log("Received 401 error, attempting token refresh...");if(localStorage.getItem("token"))try{const t=await a.A.post(`${i}/api/auth/refresh`),{access_token:s}=t.data;localStorage.setItem("token",s);const r=e.config;return r.headers.Authorization=`Bearer ${s}`,(0,a.A)(r)}catch(r){console.error("Token refresh failed:",r),localStorage.removeItem("token"),window.location.href="/"}}return Promise.reject(e)});const l={healthCheck:()=>r.get("/api/health"),getProspects:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;return r.get(`/api/prospects?skip=${e}&limit=${t}`)},createProspect:e=>r.post("/api/prospects",e),uploadProspects:e=>{const t=new FormData;return t.append("file",e),r.post("/api/prospects/upload",t,{headers:{"Content-Type":"multipart/form-data"}})},getTemplates:()=>r.get("/api/templates"),createTemplate:e=>r.post("/api/templates",e),getTemplate:e=>r.get(`/api/templates/${e}`),updateTemplate:(e,t)=>r.put(`/api/templates/${e}`,t),getCampaigns:()=>r.get("/api/campaigns"),createCampaign:e=>r.post("/api/campaigns",e),getCampaign:e=>r.get(`/api/campaigns/${e}`),sendCampaign:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};console.log("\ud83d\udce1 sendCampaign called with id:",e,"sendRequest:",t);const s={send_immediately:!0,email_provider_id:"",max_emails:1e3,schedule_type:"immediate",start_time:null,follow_up_enabled:!0,follow_up_intervals:[3,7,14],follow_up_templates:[],...t};return console.log("\ud83d\udce4 Final send request:",s),console.log("\ud83c\udfaf Making POST request to:",`/api/campaigns/${e}/send`),r.post(`/api/campaigns/${e}/send`,s)},getIntents:()=>r.get("/api/intents"),createIntent:e=>r.post("/api/intents",e),getIntent:e=>r.get(`/api/intents/${e}`),updateIntent:(e,t)=>r.put(`/api/intents/${e}`,t),deleteIntent:e=>r.delete(`/api/intents/${e}`),getCampaignAnalytics:e=>r.get(`/api/analytics/campaign/${e}`),getLists:()=>r.get("/api/lists"),createList:e=>r.post("/api/lists",e),getList:e=>r.get(`/api/lists/${e}`),updateList:(e,t)=>r.put(`/api/lists/${e}`,t),deleteList:e=>r.delete(`/api/lists/${e}`),addProspectsToList:(e,t)=>r.post(`/api/lists/${e}/prospects`,{prospect_ids:t}),removeProspectsFromList:(e,t)=>r.delete(`/api/lists/${e}/prospects`,{data:{prospect_ids:t}}),startEmailProcessing:()=>r.post("/api/email-processing/start"),stopEmailProcessing:()=>r.post("/api/email-processing/stop"),getProcessingStatus:()=>r.get("/api/email-processing/status"),getProcessingAnalytics:()=>r.get("/api/email-processing/analytics"),testIntentClassification:e=>r.post("/api/email-processing/test-classification",e),testResponseGeneration:e=>r.post("/api/email-processing/test-response",e),getThreads:()=>r.get("/api/threads"),getThread:e=>r.get(`/api/threads/${e}`),getThreadByProspect:e=>r.get(`/api/threads/prospect/${e}`),addMessageToThread:(e,t)=>r.post(`/api/threads/${e}/messages`,t),getEmailProviders:()=>r.get("/api/email-providers"),createEmailProvider:e=>r.post("/api/email-providers",e),updateEmailProvider:(e,t)=>r.put(`/api/email-providers/${e}`,t),deleteEmailProvider:e=>r.delete(`/api/email-providers/${e}`),setDefaultEmailProvider:e=>r.post(`/api/email-providers/${e}/set-default`),testEmailProvider:e=>r.post(`/api/email-providers/${e}/test-connection`),getFollowUpDashboard:()=>r.get("/api/follow-up-monitoring/dashboard"),getImapScanStatus:()=>r.get("/api/follow-up-monitoring/imap-scan-status"),getImapLogs:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:24;return r.get(`/api/follow-up-monitoring/imap-logs?hours=${e}`)},getProspectResponses:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:7;return r.get(`/api/follow-up-monitoring/prospect-responses?days=${e}`)},analyzeProspectThread:e=>r.get(`/api/follow-up-monitoring/thread-analysis/${e}`),forceStopFollowUp:e=>r.post(`/api/follow-up-monitoring/force-stop-follow-up/${e}`),restartFollowUp:e=>r.post(`/api/follow-up-monitoring/restart-follow-up/${e}`),getFollowUpHealthCheck:()=>r.get("/api/follow-up-monitoring/health-check"),startFollowUpEngine:()=>r.post("/api/follow-up-engine/start"),stopFollowUpEngine:()=>r.post("/api/follow-up-engine/stop"),getFollowUpEngineStatus:()=>r.get("/api/follow-up-engine/status"),getFollowUpStatistics:()=>r.get("/api/follow-up-engine/statistics"),processEmailResponse:e=>r.post("/api/follow-up-engine/process-response",e)},o=r},5613:(e,t,s)=>{s.d(t,{A:()=>a});const a=(0,s(1639).A)("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},7021:(e,t,s)=>{s.r(t),s.d(t,{default:()=>y});var a=s(5043),i=s(4319),r=s(9875),l=s(5613),o=s(516),n=s(1885),c=s(2861),d=s(7118);const p=(0,s(1639).A)("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);var m=s(5327),g=s(4537),h=s(4505),x=s(3768),u=s(579);const y=()=>{var e,t,s,y;const[f,v]=(0,a.useState)(!1),[w,b]=(0,a.useState)(null),[j,N]=(0,a.useState)([]),[k,_]=(0,a.useState)(null),[$,A]=(0,a.useState)("Connecting..."),[S,P]=(0,a.useState)(null),[C,T]=(0,a.useState)(!1),[E,F]=(0,a.useState)(!1);(0,a.useEffect)(()=>((async()=>{try{await D()}catch(e){console.log("WebSocket failed, falling back to polling"),T(!0),await L()}})(),()=>{k&&k.close()}),[]),(0,a.useEffect)(()=>{if(C){const e=setInterval(async()=>{await I()},5e3);return()=>clearInterval(e)}},[C]);const I=async()=>{try{const e=await h.K.get("/api/real-time/dashboard-metrics");b(e.data.metrics),P(new Date),v(!0),A("Connected (Polling)")}catch(e){console.error("Error fetching metrics:",e),v(!1),A("Disconnected")}},D=async()=>new Promise((e,t)=>{const s="https://030d008b-cc85-4bf3-afdd-411b8004d718.preview.emergentagent.com";let a;a=s.startsWith("https://")?s.replace("https://","wss://"):s.startsWith("http://")?s.replace("http://","ws://"):`ws://${s}`;const i=`dashboard-${Date.now()}`;try{const s=new WebSocket(`${a}/api/ws/${i}`);s.onopen=()=>{console.log("WebSocket Connected"),v(!0),A("Connected (WebSocket)"),_(s),T(!1),s.send(JSON.stringify({type:"subscribe",event_types:["dashboard_metrics","notifications","campaign_progress","provider_status"]})),s.send(JSON.stringify({type:"get_current_metrics"})),e(s)},s.onmessage=e=>{try{const t=JSON.parse(e.data);U(t)}catch(t){console.error("Error parsing WebSocket message:",t)}},s.onclose=()=>{console.log("WebSocket Disconnected"),v(!1),A("Disconnected"),_(null),T(!0)},s.onerror=e=>{console.error("WebSocket Error:",e),A("Error"),t(e)}}catch(r){console.error("Failed to create WebSocket:",r),A("Failed to connect"),t(r)}}),L=async()=>{A("Connecting (Polling)..."),await I()},U=(0,a.useCallback)(e=>{switch(e.type){case"metrics_update":case"current_metrics":b(e.data),P(new Date(e.timestamp));break;case"notifications":N(t=>[...t,...e.data]);break;case"notification":N(t=>[...t,e.data]);break;case"campaign_progress":console.log("Campaign progress:",e);break;case"provider_status":console.log("Provider status:",e);break;default:console.log("Unknown message type:",e.type)}},[]),M=e=>{switch(e){case"active":return(0,u.jsx)(i.A,{className:"w-4 h-4 text-green-500"});case"failed":return(0,u.jsx)(r.A,{className:"w-4 h-4 text-red-500"});default:return(0,u.jsx)(l.A,{className:"w-4 h-4 text-yellow-500"})}},W=e=>e>=1e6?(e/1e6).toFixed(1)+"M":e>=1e3?(e/1e3).toFixed(1)+"K":e.toString();return(0,u.jsxs)("div",{className:"p-6 space-y-6",children:[(0,u.jsxs)("div",{className:"flex justify-between items-center",children:[(0,u.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Real-Time Dashboard"}),(0,u.jsxs)("div",{className:"flex items-center gap-4",children:[(0,u.jsxs)("button",{onClick:async()=>{F(!0);try{C?await I():await D(),x.Ay.success("Dashboard refreshed successfully")}catch(e){x.Ay.error("Failed to refresh dashboard")}finally{F(!1)}},disabled:E,className:"flex items-center gap-2 px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:[(0,u.jsx)(o.A,{className:"w-4 h-4 "+(E?"animate-spin":"")}),"Refresh"]}),(0,u.jsxs)("div",{className:"flex items-center gap-2",children:[f?(0,u.jsx)(n.A,{className:"w-5 h-5 text-green-500"}):(0,u.jsx)(c.A,{className:"w-5 h-5 text-red-500"}),(0,u.jsx)("span",{className:"text-sm font-medium "+(f?"text-green-600":"text-red-600"),children:$})]})]})]}),j.length>0&&(0,u.jsx)("div",{className:"space-y-2",children:j.slice(-5).map((e,t)=>(0,u.jsx)("div",{className:"p-3 rounded-lg border-l-4 "+("error"===e.type?"border-red-500 bg-red-50":"warning"===e.type?"border-yellow-500 bg-yellow-50":"border-blue-500 bg-blue-50"),children:(0,u.jsxs)("div",{className:"flex justify-between items-start",children:[(0,u.jsxs)("div",{children:[(0,u.jsx)("h4",{className:"font-medium text-gray-900",children:e.title}),(0,u.jsx)("p",{className:"text-sm text-gray-600",children:e.message}),(0,u.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:new Date(e.timestamp).toLocaleTimeString()})]}),(0,u.jsx)("button",{onClick:()=>(e=>{N(t=>t.filter((t,s)=>s!==e))})(t),className:"text-gray-400 hover:text-gray-600",children:(0,u.jsx)(r.A,{className:"w-4 h-4"})})]})},t))}),w&&(0,u.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,u.jsx)("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:(0,u.jsxs)("div",{className:"flex items-center justify-between",children:[(0,u.jsxs)("div",{children:[(0,u.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total Prospects"}),(0,u.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:W((null===(e=w.overview)||void 0===e?void 0:e.total_prospects)||0)})]}),(0,u.jsx)(d.A,{className:"w-8 h-8 text-blue-500"})]})}),(0,u.jsx)("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:(0,u.jsxs)("div",{className:"flex items-center justify-between",children:[(0,u.jsxs)("div",{children:[(0,u.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Active Campaigns"}),(0,u.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:W((null===(t=w.overview)||void 0===t?void 0:t.active_campaigns)||0)})]}),(0,u.jsx)(p,{className:"w-8 h-8 text-green-500"})]})}),(0,u.jsx)("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:(0,u.jsxs)("div",{className:"flex items-center justify-between",children:[(0,u.jsxs)("div",{children:[(0,u.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Emails Today"}),(0,u.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:W((null===(s=w.overview)||void 0===s?void 0:s.emails_today)||0)})]}),(0,u.jsx)(m.A,{className:"w-8 h-8 text-purple-500"})]})}),(0,u.jsx)("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:(0,u.jsxs)("div",{className:"flex items-center justify-between",children:[(0,u.jsxs)("div",{children:[(0,u.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total Emails"}),(0,u.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:W((null===(y=w.overview)||void 0===y?void 0:y.total_emails_sent)||0)})]}),(0,u.jsx)(g.A,{className:"w-8 h-8 text-indigo-500"})]})})]}),w&&w.provider_stats&&Object.keys(w.provider_stats).length>0&&(0,u.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[(0,u.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Email Provider Status"}),(0,u.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:Object.entries(w.provider_stats).map(e=>{let[t,s]=e;return(0,u.jsxs)("div",{className:"border rounded-lg p-4",children:[(0,u.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,u.jsx)("h4",{className:"font-medium text-gray-900",children:t}),M(s.status)]}),(0,u.jsxs)("p",{className:"text-sm text-gray-600",children:["Type: ",s.type]}),(0,u.jsxs)("p",{className:"text-sm text-gray-600",children:["Usage: ",s.emails_sent_today||0," / ",s.daily_limit||"Unlimited"]}),s.daily_limit&&(0,u.jsx)("div",{className:"mt-2 w-full bg-gray-200 rounded-full h-2",children:(0,u.jsx)("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:`${Math.min(100,s.emails_sent_today/s.daily_limit*100)}%`}})})]},t)})})]}),w&&w.recent_activity&&(0,u.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[(0,u.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Recent Activity"}),(0,u.jsx)("div",{className:"space-y-3",children:w.recent_activity.map((e,t)=>(0,u.jsxs)("div",{className:"flex items-center justify-between py-2 border-b border-gray-100 last:border-b-0",children:[(0,u.jsxs)("div",{className:"flex-1",children:[(0,u.jsx)("p",{className:"text-sm font-medium text-gray-900",children:e.subject}),(0,u.jsxs)("p",{className:"text-xs text-gray-500",children:["To: ",e.recipient]})]}),(0,u.jsxs)("div",{className:"flex items-center gap-2",children:[M(e.status),(0,u.jsx)("span",{className:"text-xs text-gray-500",children:e.created_at?new Date(e.created_at).toLocaleTimeString():"Unknown"})]})]},t))})]}),S&&(0,u.jsx)("div",{className:"text-center",children:(0,u.jsxs)("p",{className:"text-sm text-gray-500",children:["Last updated: ",S.toLocaleTimeString()]})}),!w&&(0,u.jsxs)("div",{className:"text-center py-12",children:[(0,u.jsx)(g.A,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),(0,u.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Loading Dashboard"}),(0,u.jsx)("p",{className:"text-gray-600",children:"Connecting to real-time data..."})]})]})}},9875:(e,t,s)=>{s.d(t,{A:()=>a});const a=(0,s(1639).A)("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])}}]);
//# sourceMappingURL=21.91e7ac4f.chunk.js.map